<!DOCTYPE html>
<html lang="hi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Eid Mubarak Wishes</title>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            text-align: center;
            background: linear-gradient(135deg, #004d00, #006400, #DAA520, #B8860B);
            background-size: 400% 400%;
            animation: gradientBG 15s ease infinite;
            margin: 0;
            padding: 20px;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            min-height: 100vh;
            overflow-x: hidden; /* Horizontal scroll ko rokne ke liye */
            position: relative;
        }

        @keyframes gradientBG {
            0% {background-position: 0% 50%;}
            50% {background-position: 100% 50%;}
            100% {background-position: 0% 50%;}
        }

        .container {
            background-color: rgba(255, 248, 220, 0.97);
            padding: 30px;
            border-radius: 20px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.3);
            max-width: 550px;
            width: 90%;
            position: relative;
            z-index: 2;
            border: 5px solid #DAA520;
            margin-bottom: 20px; /* Ads ke liye thoda space */
        }
        #mainImage {
            max-width: 100%;
            height: auto;
            border-radius: 15px;
            margin-bottom: 25px;
            border: 3px solid #8B4513;
        }
        #greetingMessage {
            font-family: 'Georgia', 'Times New Roman', Times, serif;
            font-size: 2.5em;
            font-weight: bold;
            color: #8B0000;
            margin-bottom: 30px;
            display: none;
            animation: fadeInZoomDrop 2s forwards;
            text-shadow: 2px 2px 4px rgba(218,165,32,0.7);
        }

        @keyframes fadeInZoomDrop {
            0% { opacity: 0; transform: scale(0.5) translateY(-50px); }
            70% { opacity: 1; transform: scale(1.1) translateY(10px); }
            100% { opacity: 1; transform: scale(1) translateY(0); }
        }

        .input-group {
            margin-top: 25px;
        }
        label {
            font-weight: bold;
            color: #006400;
            display: block;
            margin-bottom: 10px;
            font-size: 1.1em;
        }
        input[type="text"] {
            padding: 15px;
            font-size: 1em;
            border: 2px solid #DAA520;
            border-radius: 10px;
            width: calc(100% - 34px);
            margin-bottom: 20px;
            box-sizing: border-box;
            background-color: #FFF8DC;
        }
        
        #shareButton {
            padding: 12px 20px;
            font-size: 1.1em;
            font-weight: bold;
            background: #25D366; /* WhatsApp Green */
            color: white;
            border: none;
            border-radius: 10px;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 4px 8px rgba(0,0,0,0.2);
            display: inline-flex; 
            align-items: center;
            justify-content: center;
        }
        #shareButton:hover {
            background: #1DAE54; 
            transform: translateY(-3px) scale(1.05);
            box-shadow: 0 6px 12px rgba(0,0,0,0.3);
        }
        #shareButton svg {
            width: 24px; 
            height: 24px;
            margin-right: 8px; 
        }

        #generatedLinkContainer {
            margin-top: 25px;
            word-break: break-all;
        }
        #generatedLink {
            color: #006400;
            text-decoration: none;
            font-weight: bold;
            font-size: 1.1em;
        }
        #generatedLink:hover {
            text-decoration: underline;
            color: #DAA520;
        }
        .instructions {
            font-size: 0.9em;
            color: #555;
            margin-top: 15px;
        }

        #fireworksCanvas {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: 1;
            pointer-events: none;
        }

        /* Ad Container Style */
        #adContainer {
            margin-top: 20px; /* Space above ad */
            margin-bottom: 20px; /* Space below ad */
            text-align: center; /* Center the ad if it's smaller than container */
            width: 100%;
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 3; /* Ads ko container ke upar rakhne ke liye (agar overlap ho) */
            position: relative;
        }

    </style>
</head>
<body>
    <canvas id="fireworksCanvas"></canvas>

    <div class="container">
        <h1 id="greetingMessage"></h1>

        <img id="mainImage" src="eid-al-adha-design-template-ffe525bd3b06293e877ce2edc18e7394_screen.jpg" alt="Eid Design Template">

        <div class="input-group">
            <label for="nameInput">Apna Naam Likhein:</label>
            <input type="text" id="nameInput" placeholder="Yahan apna naam daalen">
            <button id="shareButton" onclick="generateLink()">
                <svg viewBox="0 0 24 24" fill="currentColor">
                    <path d="M12.04 2C6.58 2 2.13 6.45 2.13 11.91C2.13 13.66 2.59 15.33 3.43 16.79L2 22L7.32 20.59C8.74 21.38 10.35 21.82 12.04 21.82C17.5 21.82 21.95 17.37 21.95 11.91C21.95 6.45 17.5 2 12.04 2ZM12.04 3.64C16.57 3.64 20.31 7.38 20.31 11.91C20.31 16.44 16.57 20.18 12.04 20.18C10.49 20.18 9.01 19.78 7.76 19.05L7.29 18.78L4.93 19.45L5.62 17.17L5.34 16.68C4.46 15.3 4.02 13.68 4.02 11.91C4.02 7.38 7.76 3.64 12.04 3.64ZM17.27 14.62C17.06 14.52 16.03 14.03 15.82 13.93C15.61 13.83 15.47 13.78 15.33 14.03C15.19 14.28 14.71 14.82 14.57 14.97C14.43 15.12 14.28 15.17 14.03 15.07C13.78 14.97 12.6 14.54 11.22 13.28C10.12 12.28 9.42 11.03 9.27 10.78C9.12 10.53 9.24 10.41 9.37 10.28C9.48 10.17 9.62 9.97 9.77 9.82C9.92 9.67 9.97 9.57 10.07 9.37C10.17 9.17 10.12 9.02 10.04 8.87C9.97 8.72 9.47 7.47 9.27 6.97C9.07 6.47 8.87 6.52 8.74 6.52C8.61 6.52 8.47 6.52 8.33 6.52C8.19 6.52 7.94 6.57 7.74 6.77C7.54 6.97 7.04 7.42 7.04 8.52C7.04 9.62 7.76 10.67 7.89 10.82C8.02 10.97 9.29 12.92 11.22 13.72C12.73 14.34 13.23 14.57 13.61 14.74C14.21 15.02 14.63 14.99 14.86 14.74C15.13 14.46 15.61 13.88 15.75 13.68C15.9 13.48 15.9 13.33 15.82 13.23C15.75 13.13 15.53 13.03 15.33 12.93C15.12 12.83 14.97 12.78 14.83 13.03C14.69 13.28 14.21 13.83 14.06 13.97C13.92 14.12 13.78 14.17 13.53 14.07C13.28 13.97 12.1 13.54 10.72 12.28C9.64 11.31 8.97 10.13 8.82 9.88C8.67 9.63 8.79 9.51 8.92 9.38C9.03 9.27 9.17 9.07 9.32 8.92C9.47 8.77 9.52 8.67 9.62 8.47C9.72 8.27 9.67 8.12 9.59 7.97C9.52 7.82 9.02 6.57 8.82 6.07C8.62 5.57 8.42 5.62 8.29 5.62C8.16 5.62 8.02 5.62 7.88 5.62C7.74 5.62 7.49 5.67 7.29 5.87C7.09 6.07 6.59 6.52 6.59 7.62C6.59 8.72 7.31 9.77 7.44 9.92C7.57 10.07 8.84 12.02 10.77 12.82C12.28 13.44 12.78 13.67 13.16 13.84C13.76 14.12 14.18 14.09 14.41 13.84C14.68 13.56 15.16 12.98 15.3 12.78C15.45 12.58 15.45 12.43 15.37 12.33C15.3 12.23 15.08 12.13 14.88 12.03C14.67 11.93 14.52 11.88 14.38 12.13C14.24 12.38 13.76 12.93 13.61 13.07C13.47 13.22 13.33 13.27 13.08 13.17C12.83 13.07 11.65 12.66 10.33 11.47C9.24 10.51 8.61 9.41 8.43 9.12C8.26 8.83 8.38 8.71 8.51 8.59C8.62 8.48 8.75 8.3 8.9 8.15C9.05 8 9.1 7.9 9.2 7.7C9.3 7.5 9.25 7.35 9.17 7.2C9.1 7.05 8.6 5.8 8.4 5.3C8.2 4.8 8 4.85 7.88 4.85C7.75 4.85 7.61 4.85 7.47 4.85C7.33 4.85 7.08 4.9 6.88 5.1C6.68 5.3 6.18 5.75 6.18 6.85C6.18 7.95 6.9 8.99 7.03 9.15C7.16 9.3 8.43 11.25 10.36 12.05C11.86 12.67 12.37 12.89 12.75 13.07C13.35 13.34 13.77 13.32 14 13.06C14.27 12.79 14.75 12.21 14.89 12.01C15.04 11.81 15.04 11.66 14.96 11.56C14.89 11.46 14.67 11.36 14.47 11.26L14.07 11.06L17.27 14.62Z"/>
                </svg>
                Share Karein
            </button>
        </div>

        <div id="generatedLinkContainer">
            <p id="linkText" class="instructions"></p>
            <a id="generatedLink" href="#" target="_blank"></a>
        </div>
    </div>

    <!-- =========== ADVERTISEMENT PLACEMENT START =========== -->
    <div id="adContainer">
        <script type="text/javascript">
            atOptions = {
                'key' : 'd2ec8f7eb6ddea1933ffb15b23fda8a0',
                'format' : 'iframe',
                'height' : 60,
                'width' : 468,
                'params' : {}
            };
        </script>
        <script type="text/javascript" src="//www.highperformanceformat.com/d2ec8f7eb6ddea1933ffb15b23fda8a0/invoke.js"></script>
    </div>
    <!-- =========== ADVERTISEMENT PLACEMENT END =========== -->


    <script>
        const greetingElement = document.getElementById('greetingMessage');
        const mainImageElement = document.getElementById('mainImage');
        const nameInputElement = document.getElementById('nameInput');
        const generatedLinkElement = document.getElementById('generatedLink');
        const linkTextElement = document.getElementById('linkText');

        const canvas = document.getElementById('fireworksCanvas');
        const ctx = canvas.getContext('2d');
        canvas.width = window.innerWidth;
        canvas.height = window.innerHeight;

        let fireworks = [];
        let particles = [];

        function Firework(sx, sy, tx, ty) {
            this.x = sx; this.y = sy; this.sx = sx; this.sy = sy; this.tx = tx; this.ty = ty;
            this.distanceToTarget = Math.sqrt(Math.pow(tx - sx, 2) + Math.pow(ty - sy, 2));
            this.distanceTraveled = 0; this.coordinates = []; this.coordinateCount = 3;
            while(this.coordinateCount--) { this.coordinates.push([this.x, this.y]); }
            this.angle = Math.atan2(ty - sy, tx - sx); this.speed = 2.8; 
            this.acceleration = 1.05; 
            this.brightness = Math.random() * 50 + 70; 
            this.targetRadius = 1;
        }

        Firework.prototype.update = function(index) {
            this.coordinates.pop(); this.coordinates.unshift([this.x, this.y]);
            if(this.targetRadius < 8) { this.targetRadius += 0.3; } else { this.targetRadius = 1; }
            this.speed *= this.acceleration; let vx = Math.cos(this.angle) * this.speed; let vy = Math.sin(this.angle) * this.speed;
            this.distanceTraveled = Math.sqrt(Math.pow(this.x + vx - this.sx, 2) + Math.pow(this.y + vy - this.sy, 2));
            if(this.distanceTraveled >= this.distanceToTarget) {
                createParticles(this.tx, this.ty); fireworks.splice(index, 1);
            } else { this.x += vx; this.y += vy; }
        }

        Firework.prototype.draw = function() {
            ctx.beginPath(); ctx.moveTo(this.coordinates[this.coordinates.length - 1][0], this.coordinates[this.coordinates.length - 1][1]);
            ctx.lineTo(this.x, this.y); ctx.strokeStyle = 'hsl(' + (Math.random() * 60 + 30) + ', 100%, ' + this.brightness + '%)';
            ctx.lineWidth = 2; 
            ctx.stroke(); ctx.beginPath(); ctx.arc(this.tx, this.ty, this.targetRadius, 0, Math.PI * 2); ctx.stroke();
        }

        function Particle(x, y) {
            this.x = x; this.y = y; this.coordinates = []; this.coordinateCount = 5;
            while(this.coordinateCount--) { this.coordinates.push([this.x, this.y]); }
            this.angle = Math.random() * Math.PI * 2; this.speed = Math.random() * 12 + 3; 
            this.friction = 0.97; 
            this.gravity = 1; 
            this.hue = Math.random() * 60 + 0; 
            this.brightness = Math.random() * 70 + 30; 
            this.alpha = 1; this.decay = Math.random() * 0.01 + 0.01; 
        }

        Particle.prototype.update = function(index) {
            this.coordinates.pop(); this.coordinates.unshift([this.x, this.y]);
            this.speed *= this.friction; this.x += Math.cos(this.angle) * this.speed;
            this.y += Math.sin(this.angle) * this.speed + this.gravity; this.alpha -= this.decay;
            if(this.alpha <= this.decay) { particles.splice(index, 1); }
        }

        Particle.prototype.draw = function() {
            ctx.beginPath(); ctx.moveTo(this.coordinates[this.coordinates.length - 1][0], this.coordinates[this.coordinates.length - 1][1]);
            ctx.lineTo(this.x, this.y); ctx.strokeStyle = 'hsla(' + this.hue + ', 100%, ' + this.brightness + '%, ' + this.alpha + ')';
            ctx.lineWidth = Math.random() * 2 + 1; 
            ctx.stroke();
        }

        function createParticles(x, y) {
            let particleCount = Math.random() * 70 + 80; 
            while(particleCount--) { particles.push(new Particle(x, y)); }
        }

        function launchAutomaticFirework() {
            if (fireworks.length < 24 && particles.length < 1200) { 
                fireworks.push(new Firework(
                    Math.random() * canvas.width * 0.8 + canvas.width * 0.1, 
                    canvas.height, 
                    Math.random() * canvas.width, 
                    Math.random() * canvas.height * 0.66 
                ));
            }
        }
        
        let fireworkInterval;
        function loop() {
            requestAnimationFrame(loop);
            if (ctx) { // Check if ctx is defined
                ctx.globalCompositeOperation = 'destination-out'; ctx.fillStyle = 'rgba(0, 0, 0, 0.3)'; 
                ctx.fillRect(0, 0, canvas.width, canvas.height); ctx.globalCompositeOperation = 'lighter';
                let i = fireworks.length; while(i--) { fireworks[i].draw(); fireworks[i].update(i); }
                let j = particles.length; while(j--) { particles[j].draw(); particles[j].update(j); }
            }
        }

        window.onload = function() {
            const urlParams = new URLSearchParams(window.location.search);
            const senderName = urlParams.get('sender');

            if (senderName) {
                greetingElement.innerHTML = `Happy Eid Mubarak from ${decodeURIComponent(senderName)}! <span style="font-size:0.8em;">🌙✨</span>`;
                greetingElement.style.display = 'block';
                mainImageElement.style.display = 'none';
                if (typeof loop === "function" && typeof launchAutomaticFirework === "function") {
                    if (canvas && ctx) { // Ensure canvas is ready
                         loop(); 
                        fireworkInterval = setInterval(launchAutomaticFirework, 250); 
                        setTimeout(() => clearInterval(fireworkInterval), 30000);
                    }
                }
            } else {
                mainImageElement.style.display = 'block';
                greetingElement.style.display = 'none';
                if(fireworkInterval) clearInterval(fireworkInterval); 
            }
        };

        async function generateLink() {
            const name = nameInputElement.value.trim();
            if (name === "") {
                alert("Kripya apna naam daalein!");
                return;
            }

            const encodedName = encodeURIComponent(name);
            const baseUrl = window.location.origin + window.location.pathname;
            const shareableLink = `${baseUrl}?sender=${encodedName}`;

            linkTextElement.textContent = "Aapka shareable link taiyar hai:";
            generatedLinkElement.href = shareableLink;
            generatedLinkElement.textContent = shareableLink;
            
            const shareTitle = 'Eid Mubarak Wishes!';
            const shareText = `${name} aapko Eid Mubarak keh rahe hain! 🌙✨ Yeh pyara sa sandesh dekhein:`;

            if (navigator.share) {
                try {
                    await navigator.share({
                        title: shareTitle,
                        text: shareText,
                        url: shareableLink,
                    });
                    console.log('Link successfully shared via Web Share API!');
                } catch (error) {
                    if (error.name !== 'AbortError') {
                        console.error('Error sharing:', error);
                        alert('Share karne mein samasya aayi. Kripya link ko manually copy karein.');
                        copyLinkToClipboard(shareableLink, "Share suvidha mein samasya aayi.");
                    } else {
                        console.log('Share aborted by user.');
                        copyLinkToClipboard(shareableLink, "Aapne share cancel kar diya hai.");
                    }
                }
            } else {
                console.log('Web Share API not supported. Falling back to direct WhatsApp or clipboard copy.');
                const whatsappUrl = `https://wa.me/?text=${encodeURIComponent(shareText + ' ' + shareableLink)}`;
                
                if (confirm("Web Share suvidha uplabdh nahi hai. Kya aap WhatsApp par share karna chahte hain? 'Cancel' par click karne se link copy ho jayega.")) {
                    window.open(whatsappUrl, '_blank');
                } else {
                    copyLinkToClipboard(shareableLink, "WhatsApp share cancel kiya gaya.");
                }
            }
        }

        function copyLinkToClipboard(link, contextMessage = "") {
            navigator.clipboard.writeText(link).then(() => {
                alert(`${contextMessage} Link aapke clipboard par copy ho gaya hai! Aap ise ab share kar sakte hain.`);
            }).catch(err => {
                console.warn('Clipboard copy failed:', err);
                alert(`${contextMessage} Link copy bhi nahi ho paya. Kripya upar dikhaye gaye link ko manually copy karein.`);
            });
        }

        window.onresize = function() {
            if (canvas && ctx) {
                canvas.width = window.innerWidth;
                canvas.height = window.innerHeight;
            }
        };

    </script>
</body>
</html>